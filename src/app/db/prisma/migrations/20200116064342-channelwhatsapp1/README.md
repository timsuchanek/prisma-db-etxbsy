# Migration `20200116064342-channelwhatsapp1`

This migration has been generated by Vignesh T.V. at 1/16/2020, 6:43:42 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."TimecampusAuth" (
  "id" text  NOT NULL  ,
  "scope" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."ChannelAuth" (
  "channelID" text  NOT NULL DEFAULT '' ,
  "createdDate" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "id" text  NOT NULL  ,
  "providerData" text    ,
  "providerToken" text    ,
  "status" text  NOT NULL DEFAULT '' ,
  "updatedDate" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "userConfig" text    ,
  "userID" text  NOT NULL DEFAULT '' ,
  "whatsappno" text    ,
  PRIMARY KEY ("id")
);

CREATE TABLE "public"."AuditLogs" (
  "createdDate" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "direction" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "message" text  NOT NULL DEFAULT '' ,
  "metadata" text    ,
  "updatedDate" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "userID" text  NOT NULL DEFAULT '' ,
  "whatsappno" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

ALTER TABLE "public"."TimecampusAuth" ADD COLUMN "channelAuth" text    REFERENCES "public"."ChannelAuth"("id") ON DELETE SET NULL;

CREATE UNIQUE INDEX "ChannelAuth.userID" ON "public"."ChannelAuth"("userID")

CREATE UNIQUE INDEX "ChannelAuth.channelID" ON "public"."ChannelAuth"("channelID")

CREATE UNIQUE INDEX "AuditLogs.userID" ON "public"."AuditLogs"("userID")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200116064342-channelwhatsapp1
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,47 @@
+datasource db {
+    provider = "sqlite"
+    url      = "file:dev.db"
+    enabled  = false
+}
+
+datasource postgres {
+    provider = "postgres"
+    url      = env("POSTGRES_URL")
+    // url      = "postgresql://vignesh:pwd0123456789@localhost:1992/channelwhatsapp"
+    default  = true
+}
+
+generator photon {
+    provider = "photonjs"
+    output   = "../../../generated/photon"
+}
+
+model TimecampusAuth {
+    id    String @default(cuid()) @id
+    scope String
+}
+
+model ChannelAuth {
+    id            String           @default(cuid()) @id
+    userID        String           @unique
+    channelID     String           @unique
+    whatsappno    String?
+    status        String
+    providerData  String?
+    providerToken String?
+    userConfig    String?
+    scopes        TimecampusAuth[]
+    createdDate   DateTime         @default(now())
+    updatedDate   DateTime         @updatedAt
+}
+
+model AuditLogs {
+    id          String   @default(cuid()) @id
+    userID      String   @unique
+    whatsappno  String
+    message     String
+    direction   String
+    metadata    String?
+    createdDate DateTime @default(now())
+    updatedDate DateTime @updatedAt
+}
```


